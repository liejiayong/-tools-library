<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="author" content="tanwan" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no,minimal-ui,viewport-fit=cover" />
    <meta name="Description" content="元宵" />
    <meta name="Keywords" content="元宵" />
    <title>元宵</title>
    <script type="text/javascript" src="js/config.js"></script>
    <script type="text/javascript" src="js/util.js"></script>
    <script type="text/javascript" src="http://image.tanwan.com/jsCommon/jquery-1.11.2.min.js"></script>
    <script type="text/javascript" src="js/swiper.min.js?v4.3.5"></script>
    <script type="text/javascript" src="js/jquery.SuperSlide.2.1.1.js"></script>
    <script type="text/javascript" src="js/imagesLoader.min.js"></script>
    <script type="text/javascript" src="js/clipboard.min.js"></script>
    <script type="text/javascript" src="js/lower.min.js?v2.1.1"></script>
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <!-- loading page -->
    <div class="relative fill-100 vf-hide pageloading" id="loadpage">
			<div class="inner">
				<div class="loading_img"></div>
				<p class="loading_rate fs-30" id="loading_rate">0%</p>
			</div>
		</div>
    <div id="pSwiper" class="swiper-container">
      <div class="swiper-wrapper">
        <!-- home page -->
        <div class="swiper-slide swiper-no-swiping page1 bg-home">
          <img src="img/logo.png" alt="" class="icon-logo" />
          <a href="javascript:;" class="jybtn btn-login tc">登录</a>
          <div class="username"><span>注销</span> | 贪玩游戏顶级用户SSSSSSSSVIP</div>
          <a href="javascript:;" class="jybtn btn-mygift tc">我的奖品</a>
          <div class="bg-time tc">活动时间-2019.2.16-2.19</div>
          <div class="bg-slogan"></div>
          <div class="bg-slogan-sub"></div>
          <div class="bg-lantern">
            <div class="tit">【活动规则】</div>
            <div class="subtit">
              <p>活动期间，每个帐号每日可以猜三道灯谜,每题限时15秒,猜中得5积分,猜错不得分</p>
              <p>积分可在本次活动中兑换奖品,豪华游戏礼包,炫酷屠龙刀外形u盘,等你来拿</p>
            </div>
            <div class="tit mt-15">【参与游戏】</div>
            <div class="subtit">
              <p>H5龙城战歌、盛世修仙、魔域神曲 、H5传奇来了（竖版）、龙腾传世、贪玩蓝月、魔法门传承、H5热血合击</p>
            </div>
            <a href="javascript:;" class="jybtn btn-start"></a>
            <a href="javascript:;" class="jybtn btn-call"></a>
            <a href="javascript:;" class="jybtn btn-gorecharge"></a>
          </div>
        </div>
        <!-- 倒计时 -->
        <div class="swiper-slide swiper-no-swiping pcountdown">
          <div class="jyb">
            <div class="scount" id="scount">3</div>
            <div class="desc">
              <p>每题限时15秒，15秒后自动跳转下一题</p>
              <p>眼疾手快，还不是你？</p>
            </div>
          </div>
        </div>
        <!-- page answer 1 -->
        <div class="swiper-slide swiper-no-swiping page2 bg-section">
          <div class="bg-lantarn tc">
            <a href="javascript:;" class="jybtn btn-back btn-back-page tc"></a>
            <div class="jy-counttime"><i class="current"></i></div>
            <div class="time-txt">剩余时间：<span class="count">15</span>s</div>
          </div>
          <div class="jy-panel jy-eachq">
            <div class="jy-qtip tc"></div>
            <div class="jy-qtit"></div>
            <div class="jy-qitem">
              <div class="qitem"></div>
              <div class="qitem"></div>
              <div class="qitem"></div>
            </div>
          </div>
        </div>
        <!-- page answer 2 -->
        <div class="swiper-slide swiper-no-swiping page2 bg-section">
          <div class="bg-lantarn tc">
            <a href="javascript:;" class="jybtn btn-back btn-back-page tc"></a>
            <div class="jy-counttime"><i class="current"></i></div>
            <div class="time-txt">剩余时间：<span class="count">15</span>s</div>
          </div>
          <div class="jy-panel jy-eachq">
            <div class="jy-qtip tc"></div>
            <div class="jy-qtit"></div>
            <div class="jy-qitem">
              <div class="qitem"></div>
              <div class="qitem"></div>
              <div class="qitem"></div>
            </div>
          </div>
        </div>
        <!-- page answer 3 -->
        <div class="swiper-slide swiper-no-swiping page2 bg-section">
          <div class="bg-lantarn tc">
            <a href="javascript:;" class="jybtn btn-back btn-back-page tc"></a>
            <div class="jy-counttime"><i class="current"></i></div>
            <div class="time-txt">剩余时间：<span class="count">15</span>s</div>
          </div>
          <div class="jy-panel jy-eachq">
            <div class="jy-qtip tc"></div>
            <div class="jy-qtit"></div>
            <div class="jy-qitem">
              <div class="qitem"></div>
              <div class="qitem"></div>
              <div class="qitem"></div>
            </div>
          </div>
        </div>
        <!-- page recharge gift -->
        <div class="swiper-slide swiper-no-swiping pagerecharge bg-section">
          <div class="bg-lantarn tc">
            <a href="javascript:;" class="jybtn btn-back tc"></a>
            <div class="jy-tit"></div>
          </div>
          <div class="jy-panel">
            <div class="tc tit">数量有限，先到先得</div>
            <div class="recharge-item">
              <div class="icon"><img src="img/icon-recharge-1.png" alt="" /></div>
              <div class="desc">
                <div class="tit">元宵欢聚礼包</div>
                <div class="integral">10积分兑换</div>
                <a href="javascript:;" class="jybtn btn-rechargegift tc disable">立即兑换</a>
              </div>
            </div>
            <div class="recharge-item">
              <div class="icon"><img src="img/icon-recharge-2.png" alt="" /></div>
              <div class="desc">
                <div class="tit">手工灯笼套装</div>
                <div class="integral">20积分兑换</div>
                <a href="javascript:;" class="jybtn btn-rechargegift tc">立即兑换</a>
              </div>
            </div>
            <div class="recharge-item">
              <div class="icon"><img src="img/icon-recharge-3.png" alt="" /></div>
              <div class="desc">
                <div class="tit">屠龙刀造型U盘</div>
                <div class="integral">50积分兑换</div>
                <a href="javascript:;" class="jybtn btn-rechargegift tc">立即兑换</a>
              </div>
            </div>
            <div class="my-integral tc">我的积分：<span id="myIntegral">0</span></div>
          </div>
        </div>
      </div>
    </div>

    <!--旋屏提示 -->
    <div id="orientLayer" class="orient">
      <div class="orient_content">
        <i class="orient_icon"></i>
        <div class="orient_desc">为了更好的体验，请使用竖屏浏览</div>
      </div>
    </div>

    <!-- 音乐 -->
    <!-- <div id="J_music" class="music"></div> -->
    <!-- <audio controller loop src="audio/bgm.mp3" id="bgm"></audio> -->
    <div class="audiolist">
      <audio controller src="audio/bg-suc.mp3" class="chose-suc" id="audioSuc"></audio>
      <audio controller src="audio/bg-fail.mp3" class="chose-fail" id="audioFail"></audio>
    </div>
    <!-- pop 指引分享 -->
    <div class="pop pop-share " id="popShare">
      <img src="img/bg-share.png" alt="" class="popshareimg" />
    </div>

    <!-- pop 我的奖品 -->
    <div class="pop pop-myprize " id="J_myprizePop">
      <div class="pop_mask"></div>
      <div class="pop_main">
        <a href="javascript:;" class="jybtn btn-close"></a>
        <div class="pop_body">
          <div class="jy-table">
            <div class="table-tit">
              <div class="tablecell">奖励</div>
              <div class="tablecell">备注</div>
              <div class="tablecell">状态</div>
            </div>
            <div class="table-body">
              <div class="table-item">
                <div class="tablecell">屠龙刀U盘</div>
                <div class="tablecell">数量：1</div>
                <div class="tablecell btn-address">填写收件信息</div>
              </div>
              <div class="table-item">
                <div class="tablecell">屠龙刀U盘</div>
                <div class="tablecell">数量：1</div>
                <div class="tablecell btn-address">填写收件信息</div>
              </div>
              <div class="table-item">
                <div class="tablecell">屠龙刀U盘</div>
                <div class="tablecell">数量：1</div>
                <div class="tablecell btn-address">填写收件信息</div>
              </div>
              <div class="table-item">
                <div class="tablecell">屠龙刀U盘</div>
                <div class="tablecell">数量：1</div>
                <div class="tablecell btn-address">填写收件信息</div>
              </div>
              <div class="table-item">
                <div class="tablecell">屠龙刀U盘</div>
                <div class="tablecell">数量：1</div>
                <div class="tablecell btn-address">填写收件信息</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- pop 积分不足tip -->
    <div class="pop pop-integral-tip " id="J_integraltipPop">
      <div class="pop_mask"></div>
      <div class="pop_main">
        <a href="javascript:;" class="jybtn btn-close"></a>
        <div class="pop_body">
          <div class="tip tc">积分不足无法兑换</div>
          <a href="javascript:;" class="jybtn btn-ok"></a>
        </div>
      </div>
    </div>

    <!-- pop 游戏选择 -->
    <div class="pop pop-gamechose " id="J_gamechosePop">
      <div class="pop_mask"></div>
      <div class="pop_main">
        <a href="javascript:;" class="jybtn btn-close"></a>
        <div class="pop_body">
          <div class="tip tc">确定以【5积分】兑换游戏礼包？</div>
          <select name="" id="" class="popselect tc">
            <option value="">--选择游戏--</option>
            <option value="贪玩蓝月">贪玩蓝月</option>
          </select>
          <a href="javascript:;" class="jybtn btn-ok"></a>
        </div>
      </div>
    </div>

    <!-- pop 积分兑换礼品 -->
    <div class="pop pop-recharge " id="J_rechargePop">
      <div class="pop_mask"></div>
      <div class="pop_main">
        <a href="javascript:;" class="jybtn btn-close"></a>
        <div class="pop_body">
          <div class="tip tc">确定以【50积分】兑换屠龙刀U盘？</div>
          <a href="javascript:;" class="jybtn btn-ok" id="btnRechargeGitf"></a>
        </div>
      </div>
    </div>

    <!-- pop 积分兑换礼品 suc -->
    <div class="pop pop-recharge-suc " id="J_rechargesucPop">
      <div class="pop_mask"></div>
      <div class="pop_main">
        <a href="javascript:;" class="jybtn btn-close"></a>
        <div class="pop_body">
          <div class="tip tc">请填写收件地址</div>
          <div class="popinput">
            <div class="popinput-cell">
              <div class="popinput-tit">姓&nbsp;&nbsp;&nbsp;&nbsp;名：</div>
              <div class="popinput-inp"><input placeholder="请输入内容" type="text" name="" id="" /></div>
            </div>
            <div class="popinput-cell">
              <div class="popinput-tit">联系电话：</div>
              <div class="popinput-inp"><input placeholder="请输入内容" type="text" name="" id="" /></div>
            </div>
            <div class="popinput-cell">
              <div class="popinput-tit">收货地址：</div>
              <div class="popinput-inp"><input placeholder="请输入内容" type="text" name="" id="" /></div>
            </div>
          </div>
          <a href="javascript:;" class="jybtn btn-ok"></a>
        </div>
      </div>
    </div>

    <!-- pop 答对 tip -->
    <div class="pop pop-qsuc " id="J_qsucPop">
      <div class="pop_mask"></div>
      <div class="pop_main">
        <a href="javascript:;" class="jtbtn btn-close btn-gohome"></a>
        <div class="pop_body">
          <div class="tip tc">
            <p>恭喜你，答对<span id="resultR">0</span>题</p>
            <p>获得<span id="resultInte">0</span>积分~</p>
          </div>
          <a href="javascript:;" class="jybtn btn-gorecharge"></a>
        </div>
      </div>
    </div>

    <!-- pop 答题退出 tip -->
    <div class="pop pop-qsuc " id="J_qQuitPop">
      <div class="pop_mask"></div>
      <div class="pop_main">
        <a href="javascript:;" class="jtbtn btn-close"></a>
        <div class="pop_body">
          <div class="tip tc">
            <p>中途退出猜灯谜，会失去</p>
            <p>今天的答题机会噢</p>
          </div>
          <a href="javascript:;" class="jybtn btn-ok" id="btnqBack"></a>
        </div>
      </div>
    </div>

    <!-- pop 复制激活码 -->
    <div class="pop pop-qsuc" id="J_ccodePop">
      <div class="pop_mask"></div>
      <div stlye="color: inherit;" class="pop_main">
        <a href="javascript:;" class="jtbtn btn-close"></a>
        <div class="pop_body">
          <div style="padding-top:0;line-height:1.8;" class="tip tc">
            <p style="font-size:.32rem"><span class="color-orange">恭喜你获得：</span> <span>王者礼包</span></p>
            <p style="font-size:.28rem"><span class="color-orange">激活码：</span><span>bmcXNRRigOCl06aR</span></p>
            <p style="font-size:.22rem">(长按复制礼包码)</p>
          </div>
          <a href="javascript:;" style="margin-top: .2rem;" class="jybtn btn-ok" id="btnqBack"></a>
        </div>
      </div>
    </div>

    <script type="text/javascript">
      var activeCls = 'active',
        qestionActiveCls = 'active fail suc',
        qestionSucCls = 'suc',
        qestionFailCls = 'fail',
        timePauseCls = 'pause',
        btnDisableCls = 'disable',
        TYPE_QUESTION_TOTAL = 3, // 题目总是
        TYPE_NUMBER_DURATION = 800, // 答题选中停顿时间
        TYPE_INTEGRAL_ADD = 5, // 答对获得积分
        TYPE_TIME_EACH = 1000, // 定时时间
        TYPE_TIME_DURARION = 15000, // 游戏时间
        imgBaseUrl = 'http://192.168.6.30:5000/tanwan-file/tanwan-static-page%E4%B8%93%E9%A2%98/201902011400%E5%8E%9F%E5%9E%8B%E5%9B%BE-%E5%85%83%E5%AE%B5/src/img/', // 用于图片地址
        audioBaseUrl = 'http://192.168.6.30:5000/tanwan-file/tanwan-static-page%E4%B8%93%E9%A2%98/201902011400%E5%8E%9F%E5%9E%8B%E5%9B%BE-%E5%85%83%E5%AE%B5/src/audio/', // 用于音频的地址
        result = {
          right: 0, // 答对数
          totalIntegral: 0, // 用户总积分
          integral: 0, // 每次游戏答对积分
          qIndex: 0, // 答题索引
          gametime: 1 // 剩余游戏次数
        },
        ansIndexList = [0, 1, 2], // 问题索引数据
        currentTime = 0, // 答题时间
        timer = null, // 计时器
        pSwiper = null,
        bgSound = null, // 背景音乐Obj
        timeoutSound = null, // 超时音乐Obj 
        bgaudio = [audioBaseUrl + 'bgm.mp3']; // 背景音乐
        timeoutaudio = [audioBaseUrl + 'bg-fail.mp3']; // 超时音乐音乐

      $(function() {
        // 初始化页面
        subject.initial();
        // 初始化题目
        initialQuestion(ansIndexList);

        // 关闭弹窗
        $('.close,.pop_mask,.btn-close,.popshareimg').on('click', function() {
          $(this)
            .parents('.pop')
            .fadeOut();
        });

        // pop 我的奖品
        $('.btn-mygift').on(
          'click',
          debounce(function() {
            $('#J_myprizePop').fadeIn();
          }, 100)
        );

        // 跳转至兑换奖励页
        $('.btn-gorecharge').on(
          'click',
          debounce(function() {
            resetData();
            $('#J_qsucPop').fadeOut();
            pSwiper.slideTo(5, 0);
          }, 100)
        );

        // pop 指引分享
        $('.btn-call').on(
          'click',
          debounce(function() {
            $('#popShare').fadeIn();
          }, 100)
        );

        // pop 回退到首页
        $('.pagerecharge .btn-back,.btn-gohome').on(
          'click',
          debounce(function() {
            resetData();
            pSwiper.slideTo(0, 0);
          }, 100)
        );

        // pop 回退到首页
        $('.page2 .btn-back-page').on(
          'click',
          debounce(function() {
            if (result.gametime === 0 && result.qIndex === 3) return pSwiper.slideTo(0, 0);
            clearInterval(timer);
            $('#J_qQuitPop').fadeIn();
          }, 100)
        );

        // btn 回退到首页
        $('#btnqBack').on(
          'click',
          debounce(function() {
            $('#J_qQuitPop').fadeOut();
            pSwiper.slideTo(0, 0);
          }, 100)
        );


        // pop 兑换奖励
        $('.btn-rechargegift').on(
          'click',
          debounce(function() {
            if ($(this).hasClass(btnDisableCls)) return alert('奖品已兑磬！');
            $('#J_rechargePop').fadeIn();
          }, 100)
        );

        // pop 兑换奖励SUc
        $('#btnRechargeGitf').on(
          'click',
          debounce(function() {
            $('#J_rechargePop').fadeOut();
            $('#J_gamechosePop').fadeIn();
          }, 100)
        );

        // pop 兑换奖励SUc
        $('.btn-address').on(
          'click',
          debounce(function() {
            $('#J_myprizePop').fadeOut();
            $('#J_rechargesucPop').fadeIn();
          }, 100)
        );

        // 选择题目
        $('.qitem').on(
          'click',
          debounce(function() {
            chooseCard($(this));
          }, 100)
        );

        
        // 开始游戏
        $('.btn-start').on(
          'click',
          debounce(function() {
            if (result.gametime === 0) return alert('今天游戏次数已用完，请明天再来，谢谢！');
            result.gametime--;
            pSwiper.slideNext(0);
            
            // 倒计时
            var count = 3;
            var dur = null;
            function countdown() {
              if (count <= 0) {
                clearTimeout(dur);
                count = 0;
                pSwiper.slideNext(0);
                timeProgress();
              } else {
                $('#scount').text(count);
                dur = setTimeout(countdown, 1000);
              }
              --count;
            }
            countdown();
          }, 100)
        );

      });

      // 定义初始化
      var subject = {
        initial: function() {
          this.proload();
          this.music();
          this.font();
          // this.swiper();
        },
        // 滚动
        swiper: function() {
          pSwiper = new Swiper('#pSwiper', {
            autoplay: false,
            // direction: 'vertical',
            initialSlide: 0,
            speed: TYPE_NUMBER_DURATION,
            width: window.innerWidth,
            on: {
              slideChange: function() {
                var index = this.activeIndex;

                // swiper滑动到兑换奖品页
                if (index === 5) {
                  $('#myIntegral').text(result.totalIntegral);
                }
              }
            }
          });
        },
        // 音乐
        music: function() {
          // 背景音乐
          bgSound = new Howl({
            src: bgaudio,
            autoplay: true,
            loop: true,
            volume: 0.35
          });
          bgSound.play();

          // 超时音乐
          timeoutSound = new Howl({
            src: timeoutaudio
          });
        },
        // 预加载
        proload: function() {
          var loader = new ImagesLoader();
          loader.loadImages(["bg-answer.png","bg-home.png","bg-lantern.png","bg-lantern1.png","bg-p1.png","bg-pop.png","bg-pop1.png","bg-share.png","bg-slogan-sub.png","bg-slogan.png","bg-time.png","btn-1.png","btn-back.png","btn-close.png","btn-ok.png","btn-recharge.png","btn-start.png","icon-recharge-1.png","icon-recharge-2.png","icon-recharge-3.png","icon-tit-recharge.png","logo.png","pixels.png","tw_logo.png"], imgBaseUrl);
          loader.complete(function() {
            subject.swiper();
            $('#loadpage').fadeOut(500);
            $('#pSwiper').addClass(activeCls);
          });
          loader.process(function() {
            var prsnum = this.processNum ? this.processNum : 100;
            $('#loading_rate').html(prsnum + '%');
          });
          loader.start();
        },
        // 字体适配
        font: function() {
          var docEl = document.documentElement;
          var resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize';
          var reCalc = function() {
            var clientWidth = docEl.clientWidth;
            if (!clientWidth) return;
            window.baseFontSize = 100 * (clientWidth / 750);
            docEl.style.fontSize = window.baseFontSize + 'px';
            // 屏幕提示
            var w = document.body.clientWidth;
            var h = document.body.clientHeight;
            if (h > w) {
              $('.Screen-win').fadeOut();
            } else {
              $('.Screen-win').fadeIn();
            }
          };
          if (!document.addEventListener) return;
          reCalc();
          window.addEventListener(resizeEvt, reCalc, false);
          document.addEventListener('DOMContentLoaded', reCalc, false);
        }
      };
    </script>
  </body>
</html>
